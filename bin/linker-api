#!/usr/bin/env ruby

BASEDIR = File.absolute_path "#{File.dirname $0}/.."
ETCDIR = "#{BASEDIR}/etc"
VARDIR = "#{BASEDIR}/var"
SHAREDIR = "#{BASEDIR}/share"
LIBDIR = "#{BASEDIR}/lib"

require "#{LIBDIR}/apiapp"
require "#{LIBDIR}/linkerapi"
require 'rack'

module Cfg; module_eval File.read "#{ETCDIR}/linker.conf"; end

Rack::Server.start(
  Port: Cfg::API::PORT,
  app: APIApp.new(
    LinkerAPI, Cfg::API::DATAFILE, Cfg::API::WORDFILE,
    log: Logger.new(Cfg::API::LOG)
  )
)
